
# Zabbix Backup & Restore Script for Sanya

[![License](https://img.shields.io/badge/License-Apache_2.0-blue.svg)](https://opensource.org/licenses/Apache-2.0) ![Platform](https://img.shields.io/badge/Platform-Linux-lightgrey.svg) ![Bash](https://img.shields.io/badge/Shell-Bash-green.svg) 

## Легкий примитивный скрипт для бэкапа и восстановления Zabbix.
### На данный момент заточен под использование в appliance сборке (Alma Linux, MySQL, nginx), но со временем можно будет и под другие конфигурации допилить.
 
 #### Полный бэкап сервера Zabbix в один архив:
- База данных MySQL
- Конфигурационные файлы `/etc/zabbix`
- Настройки веб-интерфейса (Nginx/PHP-FPM)
- Метаданные сервисов

#### Использование

    # zbrsfs.sh [backup | restore] [--backup=/path/to/backup.tar.gz]

Ключи `backup` и `restore` заставляют утилиту бэкапить и ресторить Zabbix, используя путь по умолчанию (прибит гвоздями в начале скрипта, в планах добавить поддержу внешнего файла конфигурации). Такой вызов подходит для планировщика cron, что бы добавить нечто вроде

    0 3 * * * /path/to/zbrsfs.sh backup
и спать спокойно (наверное). Утилита будет создавать бэкапы с указанием даты и времени в названии, так же будет создаваться симлинк **latest** на самый свежий бэкап - он будет восстанавливаться при использовании ключа `restore`. Так же в планах добавить функционал для контроля количества бэкапов и точно спать спокойно (наверное).
Дополнительный ключ `--backup=/path/to/backup.tar.gz`позволяет задать конкретный путь для создания бэкапа или указать бэкап, который требуется развернуть. Тоже можно использовать в планировщике или своих скриптах для более изысканных сценариев.
Задача у утилиты тривиальная - создать/развернуть бэкап, поэтому городить комбайн с поэтапным мониторингом процесса, контролем загрузки ЦП и ОЗУ, уведомлениями о каждом вздохе, вебхуками и прочими очень нужными функциями смысла не вижу, т.к. нам с Саней хватает (а езе zbrsfs.sh легко и непринужденно встраивается в костыль любой сложности и масштаба). Но в любом случае предложениям и советам буду рад.
